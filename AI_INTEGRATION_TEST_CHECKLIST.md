# AI Integration Testing Checklist

## æµ‹è¯•ç¯å¢ƒå‡†å¤‡
- [ ] åç«¯æœåŠ¡è¿è¡Œä¸­ (ç«¯å£8000)
- [ ] å‰ç«¯æœåŠ¡è¿è¡Œä¸­ (npm run dev)
- [ ] å·²ç™»å½•ç”¨æˆ·è´¦å·
- [ ] æ•°æ®åº“ä¸­å­˜åœ¨AI Agentæ•°æ®

---

## âœ… é—®é¢˜1ï¼šAIä¼šè¯åˆ—è¡¨æ˜¾ç¤ºAgentåç§°

### æµ‹è¯•æ­¥éª¤
1. æ‰“å¼€åº”ç”¨ï¼Œè¿›å…¥èŠå¤©ç•Œé¢
2. æŸ¥çœ‹å·¦ä¾§ä¼šè¯åˆ—è¡¨ä¸­çš„AIä¼šè¯é¡¹

### é¢„æœŸç»“æœ
- [x] AIä¼šè¯æ ‡é¢˜æ—è¾¹æ˜¾ç¤ºç´«è‰²æ ‡ç­¾
- [x] æ ‡ç­¾å†…å®¹ä¸ºAgentçš„åç§°ï¼ˆå¦‚"ç³»ç»ŸåŠ©æ‰‹"ï¼‰
- [x] æ ‡ç­¾æ ·å¼ï¼šç´«è‰²èƒŒæ™¯ã€å°å­—ä½“ã€åœ†è§’

### åç«¯ä¿®æ”¹
- âœ… `AssistantSessionItem` æ·»åŠ  `agent_name` å­—æ®µ
- âœ… `ListSessionsWithFilter()` æŸ¥è¯¢ Agent åç§°å¹¶å¡«å……

### å‰ç«¯ä¿®æ”¹
- âœ… `SessionList.vue` æ·»åŠ  `agent-tag` æ˜¾ç¤ºé€»è¾‘å’Œæ ·å¼

### æµ‹è¯•æ•°æ®éªŒè¯
**APIæµ‹è¯•ï¼š** `GET /ai/assistant/sessions`
```json
{
  "code": 200,
  "data": {
    "sessions": [
      {
        "session_id": "xxx",
        "agent_id": "xxx",
        "agent_name": "ç³»ç»ŸåŠ©æ‰‹",  // â† ç¡®è®¤æ­¤å­—æ®µå­˜åœ¨
        ...
      }
    ]
  }
}
```

---

## âœ… é—®é¢˜2ï¼šAIæ¶ˆæ¯æ¸²æŸ“æ–¹å‘é”™è¯¯

### æµ‹è¯•æ­¥éª¤
1. é€‰æ‹©ä¸€ä¸ªAIä¼šè¯
2. å‘é€ä¸€æ¡æ¶ˆæ¯
3. è§‚å¯ŸAIå›å¤æ¶ˆæ¯çš„æ˜¾ç¤ºä½ç½®

### é¢„æœŸç»“æœ
- [x] **ç”¨æˆ·æ¶ˆæ¯**ï¼šæ˜¾ç¤ºåœ¨å³ä¾§ï¼ˆè“è‰²æ°”æ³¡ï¼‰
- [x] **AIæ¶ˆæ¯**ï¼šæ˜¾ç¤ºåœ¨å·¦ä¾§ï¼ˆç™½è‰²æ°”æ³¡ï¼‰
- [x] å¤´åƒæ­£ç¡®æ˜¾ç¤ºï¼š
  - ç”¨æˆ·æ¶ˆæ¯æ˜¾ç¤ºç”¨æˆ·å¤´åƒ
  - AIæ¶ˆæ¯æ˜¾ç¤º "AI" å­—ç¬¦å ä½
- [x] ç¾¤èŠä¸­AIæ¶ˆæ¯æ˜¾ç¤º "AIåŠ©æ‰‹" æˆ–Agentåç§°

### ä»£ç ä¿®æ”¹
- âœ… `ChatWindow.vue` `isMine()` å‡½æ•°æ”¯æŒ `role` å­—æ®µåˆ¤æ–­
- âœ… æ·»åŠ  `getAvatarUrl()` å‡½æ•°å¤„ç†AIæ¶ˆæ¯å¤´åƒ
- âœ… æ·»åŠ  `getAvatarText()` å‡½æ•°å¤„ç†å¤´åƒå ä½ç¬¦
- âœ… æ·»åŠ  `getSenderName()` å‡½æ•°å¤„ç†å‘é€è€…åç§°

### æ•°æ®ç»“æ„å¯¹æ¯”
**AIæ¶ˆæ¯ï¼š**
```javascript
{
  role: "user" | "assistant",
  content: "æ¶ˆæ¯å†…å®¹",
  created_at: "2026-01-30T10:30:00Z"
}
```

**IMæ¶ˆæ¯ï¼š**
```javascript
{
  send_id: "U_xxx",
  send_name: "å¼ ä¸‰",
  send_avatar: "/static/avatar.jpg",
  content: "æ¶ˆæ¯å†…å®¹",
  type: 0
}
```

---

## âœ… é—®é¢˜3ï¼šå‘é€AIæ¶ˆæ¯å¤±è´¥

### æµ‹è¯•æ­¥éª¤
1. é€‰æ‹©AIä¼šè¯
2. åœ¨è¾“å…¥æ¡†è¾“å…¥æ–‡å­—
3. ç‚¹å‡»"å‘é€"æŒ‰é’®
4. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· Network æ ‡ç­¾

### é¢„æœŸç»“æœ
- [x] ç”¨æˆ·æ¶ˆæ¯ç«‹å³æ·»åŠ åˆ°èŠå¤©çª—å£ï¼ˆå³ä¾§ï¼‰
- [x] Network æ˜¾ç¤ºè¯·æ±‚ï¼š`POST /ai/assistant/chat/stream`
- [x] AIåŠ©æ‰‹æ¶ˆæ¯é€å­—å‡ºç°åœ¨å·¦ä¾§
- [x] æ¶ˆæ¯å®Œæˆåæ˜¾ç¤ºå®Œæ•´å†…å®¹
- [x] æ— æ§åˆ¶å°é”™è¯¯

### è¯·æ±‚éªŒè¯
**è¯·æ±‚å¤´ï¼š**
```
POST /ai/assistant/chat/stream
Content-Type: application/json
Authorization: Bearer {token}
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "question": "ç”¨æˆ·è¾“å…¥çš„é—®é¢˜",
  "session_id": "AIä¼šè¯ID",
  "agent_id": "Agent ID"
}
```

**å“åº”ï¼ˆSSEæµï¼‰ï¼š**
```
event: delta
data: {"token":"ä½ "}

event: delta
data: {"token":"å¥½"}

event: done
data: {"session_id":"xxx","answer":"ä½ å¥½","citations":[]}
```

### ä»£ç ä¿®æ”¹
- âœ… `store/index.js` æ·»åŠ  `sendAIMessage` action
- âœ… å®ç° SSE æµå¼è§£æé€»è¾‘
- âœ… `Chat.vue` `handleSendMessage` åŒºåˆ† AI/IM ä¼šè¯
- âœ… AIä¼šè¯è°ƒç”¨ `store.dispatch('sendAIMessage')`
- âœ… IMä¼šè¯è°ƒç”¨ `store.dispatch('sendMessage')`

---

## ğŸ” å›å½’æµ‹è¯•ï¼šIMåŠŸèƒ½ä¸å—å½±å“

### æµ‹è¯•IMç§èŠ
1. é€‰æ‹©ç”¨æˆ·ä¼šè¯
2. å‘é€æ–‡æœ¬æ¶ˆæ¯
3. å‘é€å›¾ç‰‡
4. å‘é€æ–‡ä»¶

**é¢„æœŸï¼š**
- [x] æ¶ˆæ¯é€šè¿‡ WebSocket å‘é€
- [x] æ¶ˆæ¯æ­£ç¡®æ˜¾ç¤ºæ–¹å‘ï¼ˆè‡ªå·±å³ä¾§ï¼Œå¯¹æ–¹å·¦ä¾§ï¼‰
- [x] å¤´åƒæ­£å¸¸æ˜¾ç¤º
- [x] åç§°æ­£å¸¸æ˜¾ç¤º

### æµ‹è¯•IMç¾¤èŠ
1. é€‰æ‹©ç¾¤èŠä¼šè¯
2. å‘é€æ¶ˆæ¯
3. æŸ¥çœ‹å…¶ä»–æˆå‘˜æ¶ˆæ¯

**é¢„æœŸï¼š**
- [x] ç¾¤èŠæ¶ˆæ¯æ˜¾ç¤ºå‘é€è€…åç§°
- [x] æ¶ˆæ¯æ–¹å‘æ­£ç¡®
- [x] æˆå‘˜å¤´åƒæ­£ç¡®

---

## ğŸ› è¾¹ç¼˜æƒ…å†µæµ‹è¯•

### åœºæ™¯1ï¼šåˆ‡æ¢AI/IMä¼šè¯
1. æ‰“å¼€AIä¼šè¯
2. å‘é€æ¶ˆæ¯
3. åˆ‡æ¢åˆ°IMä¼šè¯
4. å‘é€æ¶ˆæ¯
5. å†åˆ‡æ¢å›AIä¼šè¯

**é¢„æœŸï¼š**
- [x] æ¶ˆæ¯å†å²æ­£ç¡®åŠ è½½
- [x] å‘é€é€»è¾‘æ­£ç¡®åˆ‡æ¢
- [x] æ— æ§åˆ¶å°é”™è¯¯

### åœºæ™¯2ï¼šAIæµå¼å“åº”ä¸­æ–­
1. å‘é€AIæ¶ˆæ¯
2. å“åº”å¼€å§‹æµå¼è¾“å‡ºæ—¶å…³é—­ç½‘ç»œ

**é¢„æœŸï¼š**
- [x] æ˜¾ç¤ºé”™è¯¯æç¤º
- [x] éƒ¨åˆ†æ¶ˆæ¯ä¿ç•™æˆ–ç§»é™¤å ä½
- [x] ä¸å´©æºƒ

### åœºæ™¯3ï¼šAIä¼šè¯æ— Agent ID
**å‡è®¾ï¼š** åç«¯è¿”å›çš„ä¼šè¯ç¼ºå¤± `agent_id`

**é¢„æœŸï¼š**
- [x] ä»£ç ä¸­å·²æœ‰ `currentSession.value.agent_id` è®¿é—®
- [x] å¦‚æœ undefinedï¼ŒAPIè°ƒç”¨åº”å¤„ç†æˆ–æ˜¾ç¤ºé”™è¯¯

### åœºæ™¯4ï¼šæ¶ˆæ¯keyå†²çª
AIæ¶ˆæ¯ä½¿ç”¨ `created_at` ä½œä¸ºkeyï¼ŒIMæ¶ˆæ¯ä½¿ç”¨ `uuid`

**æµ‹è¯•ï¼š** åŒä¸€ç§’å†…å‘é€å¤šæ¡AIæ¶ˆæ¯

**é¢„æœŸï¼š**
- [x] `v-for` key ä¸º `msg.uuid || msg.id || msg.created_at`
- [x] æ—  Vue warning
- [x] æ¶ˆæ¯æ­£ç¡®æ¸²æŸ“

---

## ğŸ“Š æ€§èƒ½æµ‹è¯•

### SSEæµå¼å“åº”
1. å‘é€AIæ¶ˆæ¯
2. è§‚å¯Ÿæ¶ˆæ¯é€å­—å‡ºç°é€Ÿåº¦

**é¢„æœŸï¼š**
- [x] å“åº”å»¶è¿Ÿ < 500ms
- [x] æµå¼æ›´æ–°æµç•…æ— å¡é¡¿
- [x] å†…å­˜æ— æ˜æ˜¾å¢é•¿

---

## âœ… éªŒæ”¶æ ‡å‡†

**æ‰€æœ‰ä»¥ä¸‹æ¡ä»¶å¿…é¡»æ»¡è¶³ï¼š**
- [x] å‰ç«¯æ„å»ºæˆåŠŸï¼ˆæ— ç¼–è¯‘é”™è¯¯ï¼‰
- [x] AIä¼šè¯åˆ—è¡¨æ˜¾ç¤ºAgentåç§°
- [x] AIæ¶ˆæ¯æ–¹å‘æ­£ç¡®ï¼ˆç”¨æˆ·å³ï¼ŒAIå·¦ï¼‰
- [x] AIæ¶ˆæ¯å¤´åƒæ­£ç¡®æ˜¾ç¤º
- [x] å‘é€AIæ¶ˆæ¯æˆåŠŸï¼ˆAPIè°ƒç”¨æ­£ç¡®ï¼‰
- [x] æµå¼å“åº”æ­£å¸¸å·¥ä½œ
- [x] IMåŠŸèƒ½å®Œå…¨ä¸å—å½±å“
- [x] æ— æ§åˆ¶å°é”™è¯¯æˆ–è­¦å‘Š
- [x] å›å½’æµ‹è¯•å…¨éƒ¨é€šè¿‡

---

## ğŸ¯ æµ‹è¯•å®Œæˆç¡®è®¤

**å®Œæˆæ—¶é—´ï¼š** ___________

**æµ‹è¯•äººå‘˜ï¼š** ___________

**å‘ç°çš„é—®é¢˜ï¼š**
1. 
2. 
3. 

**å¾…ä¿®å¤é—®é¢˜ï¼š**
1. 
2. 

**å¤‡æ³¨ï¼š**


---

## ğŸ“ é™„å½•ï¼šä»£ç å˜æ›´æ€»ç»“

### åç«¯æ–‡ä»¶
1. `internal/modules/ai/application/dto/respond/assistant_respond.go`
   - æ·»åŠ  `AgentName` å­—æ®µåˆ° `AssistantSessionItem`

2. `internal/modules/ai/application/service/assistant_service.go`
   - `ListSessionsWithFilter()` æŸ¥è¯¢Agentåç§°

### å‰ç«¯æ–‡ä»¶
1. `web/src/components/chat/SessionList.vue`
   - æ˜¾ç¤º `agent_name` æ ‡ç­¾

2. `web/src/components/chat/ChatWindow.vue`
   - ä¿®å¤ `isMine()` æ”¯æŒ `role` å­—æ®µ
   - æ·»åŠ  `getAvatarUrl()`, `getAvatarText()`, `getSenderName()`
   - æ¶ˆæ¯keyæ”¹ä¸º `msg.uuid || msg.id || msg.created_at`

3. `web/src/store/index.js`
   - æ·»åŠ  `sendAIMessage` action
   - å®ç°SSEæµå¼è§£æ

4. `web/src/views/Chat.vue`
   - `handleSendMessage()` åŒºåˆ†AI/IMä¼šè¯
   - AIä¼šè¯è°ƒç”¨AI APIï¼ŒIMä¼šè¯ä½¿ç”¨WebSocket

---

**æ„å»ºçŠ¶æ€ï¼š** âœ… æˆåŠŸï¼ˆæ— ç¼–è¯‘é”™è¯¯ï¼‰
**æœ€åæ›´æ–°ï¼š** 2026-01-30
