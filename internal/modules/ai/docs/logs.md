[GIN] 2026/02/08 - 00:23:27 | 200 |       4.739ms |       127.0.0.1 | POST     "/login"
{"level":"info","ts":"2026-02-08T00:23:27.921+0800","msg":"ai job trigger by event","event_key":"user_login","tenant_user_id":"U1766924990899297500","defs":2,"func":"service.(*aiJobServiceImpl).TriggerByEvent","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":56}
{"level":"info","ts":"2026-02-08T00:23:27.922+0800","msg":"ai job instance created from event","job_def_id":1,"tenant_user_id":"U1766924990899297500","agent_id":"AGGSnZMdh3yIa","session_id":"ASItIaSFgyxoP","prompt_len":27,"func":"service.(*aiJobServiceImpl).TriggerByEvent","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":90}
{"level":"info","ts":"2026-02-08T00:23:27.927+0800","msg":"ai job instance created from event","job_def_id":1,"tenant_user_id":"U1766924990899297500","agent_id":"AGGSnZMdh3yIa","session_id":"ASItIaSFgyxoP","prompt_len":27,"func":"service.(*aiJobServiceImpl).TriggerByEvent","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":90}
[GIN] 2026/02/08 - 00:23:27 | 200 |      1.3974ms |       127.0.0.1 | POST     "/session/getUserSessionList"
[GIN] 2026/02/08 - 00:23:27 | 200 |       880.5µs |       127.0.0.1 | GET      "/ai/assistant/system-session"
[GIN] 2026/02/08 - 00:23:27 | 200 |      2.1621ms |       127.0.0.1 | POST     "/session/getGroupSessionList"
[GIN] 2026/02/08 - 00:23:27 | 200 |     11.2987ms |       127.0.0.1 | GET      "/ai/assistant/sessions"
{"level":"info","ts":"2026-02-08T00:23:32.729+0800","msg":"executing ai job instance","inst_id":22,"func":"service.(*aiJobServiceImpl).ExecuteInstance","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":237}
{"level":"info","ts":"2026-02-08T00:23:32.729+0800","msg":"ai job execute start","inst_id":22,"job_def_id":1,"tenant_user_id":"U1766924990899297500","agent_id":"AGGSnZMdh3yIa","session_id":"ASItIaSFgyxoP","prompt_len":27,"func":"service.(*aiJobServiceImpl).ExecuteInstance","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":241}
{"level":"info","ts":"2026-02-08T00:23:32.729+0800","msg":"job execution started","tenant_user_id":"U1766924990899297500","agent_id":"AGGSnZMdh3yIa","session_id":"ASItIaSFgyxoP","prompt_len":27,"func":"pipeline.(*JobExecutionPipeline).loadContextNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":51}
{"level":"info","ts":"2026-02-08T00:23:32.730+0800","msg":"executing ai job instance","inst_id":21,"func":"service.(*aiJobServiceImpl).ExecuteInstance","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":237}
{"level":"info","ts":"2026-02-08T00:23:32.730+0800","msg":"ai job execute start","inst_id":21,"job_def_id":1,"tenant_user_id":"U1766924990899297500","agent_id":"AGGSnZMdh3yIa","session_id":"ASItIaSFgyxoP","prompt_len":27,"func":"service.(*aiJobServiceImpl).ExecuteInstance","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":241}
{"level":"info","ts":"2026-02-08T00:23:32.730+0800","msg":"job execution started","tenant_user_id":"U1766924990899297500","agent_id":"AGGSnZMdh3yIa","session_id":"ASItIaSFgyxoP","prompt_len":27,"func":"pipeline.(*JobExecutionPipeline).loadContextNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":51}
{"level":"info","ts":"2026-02-08T00:23:33.049+0800","msg":"ai retrieve done","query_id":"q_QqiMICu50mHc_1770481413049979800","tenant_user_id":"U1766924990899297500","question":"请提醒用户记得喝水","top_k":5,"score_threshold":0,"filter_expr":"tenant_user_id == \"U1766924990899297500\" && kb_id == 1","total_hits":5,"returned_count":5,"chunk_ids":"138,103,101,136,125","search_ms":317,"post_process_ms":0,"duration_ms":320,"is_empty":false,"func":"pipeline.(*RetrievePipeline).buildResultNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/retrieve_graph.go","line":255}
{"level":"info","ts":"2026-02-08T00:23:33.049+0800","msg":"job execution rag retrieved","items":5,"func":"pipeline.(*JobExecutionPipeline).retrieveNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":105}
{"level":"info","ts":"2026-02-08T00:23:33.049+0800","msg":"job execution prompt built","system_len":764,"prompt_len":27,"citations":5,"func":"pipeline.(*JobExecutionPipeline).buildPromptNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":137}
{"level":"info","ts":"2026-02-08T00:23:33.069+0800","msg":"ai retrieve done","query_id":"q_Qvk7OFG3VYpD_1770481413069248300","tenant_user_id":"U1766924990899297500","question":"请提醒用户记得喝水","top_k":5,"score_threshold":0,"filter_expr":"tenant_user_id == \"U1766924990899297500\" && kb_id == 1","total_hits":5,"returned_count":5,"chunk_ids":"138,103,101,136,125","search_ms":335,"post_process_ms":0,"duration_ms":339,"is_empty":false,"func":"pipeline.(*RetrievePipeline).buildResultNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/retrieve_graph.go","line":255}
{"level":"info","ts":"2026-02-08T00:23:33.069+0800","msg":"job execution rag retrieved","items":5,"func":"pipeline.(*JobExecutionPipeline).retrieveNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":105}
{"level":"info","ts":"2026-02-08T00:23:33.069+0800","msg":"job execution prompt built","system_len":764,"prompt_len":27,"citations":5,"func":"pipeline.(*JobExecutionPipeline).buildPromptNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":137}
{"level":"info","ts":"2026-02-08T00:23:36.684+0800","msg":"job execution llm response","iteration":0,"tool_calls":1,"answer_len":0,"func":"pipeline.(*JobExecutionPipeline).chatModelNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":182}
{"level":"info","ts":"2026-02-08T00:23:36.684+0800","msg":"job execution invoking tool","tool_name":"push_notification","tool_id":"call_9rd7jscbbohns6qgihtugg67","func":"pipeline.(*JobExecutionPipeline).invokeTool","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":247}
{"level":"info","ts":"2026-02-08T00:23:36.684+0800","msg":"push_notification start","user_id":"U1766924990899297500","session_id":"ASItIaSFgyxoP","agent_id":"AGGSnZMdh3yIa","func":"handlers.(*NotificationToolHandler).handlePushNotification","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/mcp/server/handlers/notification_handler.go","line":79}
{"level":"info","ts":"2026-02-08T00:23:36.687+0800","msg":"push_notification message saved","msg_id":189,"func":"handlers.(*NotificationToolHandler).handlePushNotification","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/mcp/server/handlers/notification_handler.go","line":100}
{"level":"info","ts":"2026-02-08T00:23:36.691+0800","msg":"job execution tool executed","tool_name":"push_notification","tool_result":"{\"content\":[{\"type\":\"text\",\"text\":\"Notification pushed and saved successfully\"}]}","func":"pipeline.(*JobExecutionPipeline).toolsNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":228}
{"level":"info","ts":"2026-02-08T00:23:36.691+0800","msg":"job execution tools node done","session_id":"ASItIaSFgyxoP","tools_executed":1,"tools_ms":6,"func":"pipeline.(*JobExecutionPipeline).toolsNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":235}
[GIN] 2026/02/08 - 00:23:36 | 200 |      1.8802ms |       127.0.0.1 | POST     "/session/getUserSessionList"
[GIN] 2026/02/08 - 00:23:36 | 200 |      2.9613ms |       127.0.0.1 | POST     "/session/getGroupSessionList"
{"level":"info","ts":"2026-02-08T00:23:37.521+0800","msg":"job execution llm response","iteration":0,"tool_calls":1,"answer_len":0,"func":"pipeline.(*JobExecutionPipeline).chatModelNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":182}
{"level":"info","ts":"2026-02-08T00:23:37.521+0800","msg":"job execution invoking tool","tool_name":"push_notification","tool_id":"call_cr64mq9llh118no46er9npcz","func":"pipeline.(*JobExecutionPipeline).invokeTool","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":247}
{"level":"info","ts":"2026-02-08T00:23:37.521+0800","msg":"push_notification start","user_id":"U1766924990899297500","session_id":"ASItIaSFgyxoP","agent_id":"AGGSnZMdh3yIa","func":"handlers.(*NotificationToolHandler).handlePushNotification","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/mcp/server/handlers/notification_handler.go","line":79}
{"level":"info","ts":"2026-02-08T00:23:37.562+0800","msg":"push_notification message saved","msg_id":190,"func":"handlers.(*NotificationToolHandler).handlePushNotification","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/mcp/server/handlers/notification_handler.go","line":100}
{"level":"info","ts":"2026-02-08T00:23:37.563+0800","msg":"job execution tool executed","tool_name":"push_notification","tool_result":"{\"content\":[{\"type\":\"text\",\"text\":\"Notification pushed and saved successfully\"}]}","func":"pipeline.(*JobExecutionPipeline).toolsNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":228}
{"level":"info","ts":"2026-02-08T00:23:37.563+0800","msg":"job execution tools node done","session_id":"ASItIaSFgyxoP","tools_executed":1,"tools_ms":42,"func":"pipeline.(*JobExecutionPipeline).toolsNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":235}
[GIN] 2026/02/08 - 00:23:37 | 200 |      6.0713ms |       127.0.0.1 | POST     "/session/getUserSessionList"
[GIN] 2026/02/08 - 00:23:37 | 200 |      6.9713ms |       127.0.0.1 | POST     "/session/getGroupSessionList"
{"level":"info","ts":"2026-02-08T00:23:38.484+0800","msg":"job execution llm response","iteration":0,"tool_calls":0,"answer_len":45,"func":"pipeline.(*JobExecutionPipeline).chatModelNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":182}
{"level":"info","ts":"2026-02-08T00:23:38.486+0800","msg":"job execution completed","session_id":"ASItIaSFgyxoP","iterations":0,"answer_len":45,"func":"pipeline.(*JobExecutionPipeline).persistNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":322}
{"level":"info","ts":"2026-02-08T00:23:38.486+0800","msg":"ai job execute done","inst_id":21,"tenant_user_id":"U1766924990899297500","session_id":"ASItIaSFgyxoP","answer_len":45,"summary":"Notification pushed successfully","func":"service.(*aiJobServiceImpl).ExecuteInstance","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":279}
[GIN] 2026/02/08 - 00:23:39 | 200 |      7.6309ms |       127.0.0.1 | GET      "/ai/assistant/sessions/ASItIaSFgyxoP/messages?limit=100&offset=0"
{"level":"info","ts":"2026-02-08T00:23:40.455+0800","msg":"job execution llm response","iteration":0,"tool_calls":0,"answer_len":44,"func":"pipeline.(*JobExecutionPipeline).chatModelNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":182}
{"level":"info","ts":"2026-02-08T00:23:40.463+0800","msg":"job execution completed","session_id":"ASItIaSFgyxoP","iterations":0,"answer_len":44,"func":"pipeline.(*JobExecutionPipeline).persistNode","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/infrastructure/pipeline/job_execution_graph.go","line":322}
{"level":"info","ts":"2026-02-08T00:23:40.464+0800","msg":"ai job execute done","inst_id":22,"tenant_user_id":"U1766924990899297500","session_id":"ASItIaSFgyxoP","answer_len":44,"summary":"Notification pushed successfully","func":"service.(*aiJobServiceImpl).ExecuteInstance","file":"C:/Users/chenjun/goProject/OmniLink/internal/modules/ai/application/service/job_service.go","line":279}
[GIN] 2026/02/08 - 00:24:27 | 200 |          1m0s |       127.0.0.1 | GET      "/wss?client_id=U1766924990899297500&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1dWlkIjoiVTE3NjY5MjQ5OTA4OTkyOTc1MDAiLCJ1c2VybmFtZSI6InF3ZXF3ZSIsImlzcyI6Ik9tbmlMaW5rIiwiZXhwIjoxNzcwNTY3ODA3LCJuYmYiOjE3NzA0ODE0MDcsImlhdCI6MTc3MDQ4MTQwN30.JYcBSJbDVQtkUKOczZ4hr1oHz_1rzPtSHKroot6Pp0s"
